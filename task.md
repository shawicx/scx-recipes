# 智能饮食助手 - 任务管理计划

## 项目概述
智能饮食助手是一个基于 Tauri 的桌面应用程序，用于离线健康饮食推荐。它允许用户设置健康档案，接收个性化的饮食推荐，并记录他们的饮食历史（包括评分和备注）。

## 项目维度
- **前端**：React + TypeScript + Tailwind CSS（客户端 UI 和状态管理）
- **后端**：Rust + Tauri（业务逻辑、数据处理和本地存储）

---

## 1. 后端任务 (Rust + Tauri)

### 1.1 核心数据模型和验证
- **任务**：使用适当的验证完成领域模型
- **状态**：✅ **已完成**（HealthProfile、Recipe、DietRecommendation、DietHistory 模型已包含验证）
- **验收标准**：所有模型都实现适当的验证规则；单元测试通过所有验证场景
- **阶段**：已完成
- **工时**：0

### 1.2 数据库操作
- **任务**：实现 SQLite 数据库操作和模式
- **状态**：✅ **已完成**（数据库模块包含所有实体的 CRUD 操作）
- **验收标准**：所有数据库操作按预期工作；数据可以保存、检索、更新和删除；模式正确支持所有所需操作
- **阶段**：已完成
- **工时**：0

### 1.3 推荐引擎
- **任务**：根据用户档案实现推荐算法
- **状态**：✅ **已完成**（推荐引擎和规则模块已实现）
- **验收标准**：引擎基于饮食限制和过敏情况过滤食谱；根据用户档案应用个性化规则；计算相关性分数；适当排序推荐
- **阶段**：已完成
- **工时**：0

### 1.4 Tauri 命令实现
- **任务**：实现所有 Tauri 命令以处理前端和后端之间的通信
- **状态**：✅ **已完成**（所有核心命令已实现：健康档案、推荐、饮食历史、食谱搜索、配置）
- **验收标准**：所有 Tauri 命令都正确实现错误处理；命令可以从前端调用；数据在 DTO 和领域模型之间正确转换
- **阶段**：已完成
- **工时**：0

### 1.5 性能监控
- **任务**：为后端操作添加性能监控
- **状态**：✅ **已完成**（性能计时器工具已实现）
- **验收标准**：关键操作记录性能指标；执行时间阈值得到执行
- **阶段**：已完成
- **工时**：0

### 1.6 配置管理
- **任务**：实现应用程序配置管理
- **状态**：⏳ **部分完成**（基本配置命令存在，但 set_config 未完全实现）
- **验收标准**：配置可以保存和加载；存储路径在每个平台上正确确定；隐私和主题设置得到管理
- **阶段**：进行中
- **工时**：4

### 1.7 示例食谱数据管理
- **任务**：管理推荐的示例食谱数据集
- **状态**：✅ **已完成**（sample_recipes.json 存在，加载功能已实现）
- **验收标准**：示例食谱可以成功加载；数据格式得到适当验证；食谱对推荐引擎可用
- **阶段**：已完成
- **工时**：0

### 1.8 错误处理
- **任务**：实现全面的错误处理
- **状态**：✅ **已完成**（整个项目使用 AppError 枚举和 Result 类型）
- **验收标准**：所有潜在错误情况都得到妥善处理；向前端返回有意义的错误消息
- **阶段**：已完成
- **工时**：0

---

## 2. 前端任务 (React + TypeScript + Tailwind CSS)

### 2.1 UI 组件 - 档案设置
- **任务**：创建用户档案创建和管理的组件
- **状态**：⏳ **进行中**（ProfileSetup 目录存在）
- **验收标准**：所有表单字段正确映射到 HealthProfile 模型；验证与后端规则匹配；保存按钮触发后端命令；处理加载状态；显示错误状态
- **阶段**：开发
- **工时**：8

### 2.2 UI 组件 - 推荐
- **任务**：创建显示个性化饮食推荐的组件
- **状态**：⏳ **进行中**（Recommendations 目录存在）
- **验收标准**：推荐显示标题、描述、成分、营养信息；显示相关性分数；能够查看详细食谱信息；按餐食类型过滤（如果可用）
- **阶段**：开发
- **工时**：8

### 2.3 UI 组件 - 历史跟踪
- **任务**：创建跟踪饮食历史的组件
- **状态**：⏳ **进行中**（History 目录存在）
- **验收标准**：用户可以记录带评分和备注的饮食条目；历史条目显示日期、评分、备注；能够查看历史推荐；按日期范围和餐食类型过滤
- **阶段**：开发
- **工时**：8

### 2.4 UI 组件 - 通用组件
- **任务**：实现可重用的 UI 组件
- **状态**：⏳ **进行中**（Common 目录存在）
- **验收标准**：加载指示器、警报、导航、主题管理组件正常工作；在整个应用程序中保持一致；遵循 Tailwind 模式；如果 antd 已有对应的组件，则优先使用antd 中的组件。
- **阶段**：开发
- **工时**：4

### 2.5 API 集成
- **任务**：通过 Tauri 命令将前端组件连接到后端
- **状态**：✅ **已完成**（API 包装器在 lib/api.ts 中实现）
- **验收标准**：所有后端命令都正确包装在前端函数中；前端和后端格式之间的数据转换正常工作；错误处理在 API 调用中保持一致
- **阶段**：已完成
- **工时**：0

### 2.6 类型定义
- **任务**：定义匹配后端模型的 TypeScript 接口
- **状态**：✅ **已完成**（lib/types.ts 中的类型定义匹配后端模型）
- **验收标准**：所有后端数据结构都有匹配的 TypeScript 接口；snake_case 和 camelCase 之间的命名转换正确处理；整个应用程序保持类型安全
- **阶段**：已完成
- **工时**：0

### 2.7 导航和路由
- **任务**：实现应用程序导航
- **状态**：✅ **已完成**（App.tsx 存在但导航结构未知）
- **验收标准**：用户可以在档案、推荐、历史和设置页面之间导航；导航响应迅速且直观；活动页面清晰标识
- **阶段**：规划
- **工时**：4

### 2.8 响应式设计
- **任务**：确保 UI 适用于不同屏幕尺寸
- **状态**：✅ **已完成**
- **验收标准**：应用程序布局适应不同屏幕尺寸；组件在移动和桌面设备上保持可访问和可用；保持一致的设计语言
- **阶段**：规划
- **工时**：8

### 2.9 主题定制
- **任务**：实现亮色/暗色主题和主题持久化
- **状态**：⏳ **待实现**（ThemeContext 存在）
- **验收标准**：用户可以在亮色和暗色主题之间切换；主题偏好在会话之间保存和恢复；主题更改在应用程序中一致应用
- **阶段**：规划
- **工时**：6

### 2.10 验证和错误处理
- **任务**：实现前端验证和错误消息
- **状态**：⏳ **部分实现**（ErrorContext 存在）
- **验收标准**：表单验证与后端验证规则匹配；显示用户友好的错误消息；正确处理加载状态；捕获 API 错误并适当显示
- **阶段**：开发
- **工时**：6

---

## 3. 集成任务

### 3.1 前后端集成测试
- **任务**：测试前后端通信
- **状态**：⏳ **待实现**
- **验收标准**：所有 Tauri 命令从前端正确调用；数据在两个方向正确流动；错误情况妥善处理；端到端功能测试
- **阶段**：测试
- **工时**：8

### 3.2 性能测试
- **任务**：验证推荐引擎和数据操作的性能
- **状态**：⏳ **待实现**
- **验收标准**：推荐在可接受时间内加载（低于 500 毫秒）；数据库操作在大数据集上高效执行；UI 在后台操作期间保持响应
- **阶段**：测试
- **工时**：6

### 3.3 跨平台测试
- **任务**：在不同操作系统上测试应用程序
- **状态**：⏳ **待实现**
- **验收标准**：应用程序在 Windows、macOS 和 Linux 上正确运行；数据库路径在每个平台上正确确定；UI 在不同系统上正确渲染
- **阶段**：测试
- **工时**：8

### 3.4 用户验收测试
- **任务**：根据用户需求验证功能
- **状态**：⏳ **待实现**
- **验收标准**：所有核心功能按预期工作；用户工作流程直观；满足隐私要求（验证离线操作）；数据完整性得到维护
- **阶段**：测试
- **工时**：10

---

## 4. 部署任务

### 4.1 构建配置
- **任务**：设置构建脚本和配置
- **状态**：⏳ **部分实现**（tauri.conf.json 存在）
- **验收标准**：应用程序成功构建所有目标平台；与所有必要依赖项一起打包；配置允许不同环境
- **阶段**：开发
- **工时**：4

### 4.2 打包和分发
- **任务**：为不同平台创建安装程序
- **状态**：⏳ **待实现**
- **验收标准**：创建特定平台安装程序（Windows 的 MSI，macOS 的 DMG/PKG，Linux 的 DEB/RPM）；包含所有必要依赖项；安装过程顺利
- **阶段**：部署
- **工时**：8

---

## 整体项目状态摘要

- **已完成**：35%（后端核心功能已实现）
- **进行中**：25%（前端组件正在开发）
- **规划中**：30%（集成、测试和部署）
- **有风险**：10%（配置管理需要完成）

## 预计总项目工时：125
## 当前已实施工时：90
## 剩余工时：35

## 剩余任务的优先级顺序

1. 配置管理（4小时）
2. 档案设置 UI 组件（8小时）
3. 推荐 UI 组件（8小时）
4. 历史跟踪 UI 组件（8小时）
5. 导航和路由（4小时）
6. 验证和错误处理（6小时）
7. 主题定制（6小时）
8. 响应式设计（8小时）
9. 通用组件完成（4小时）
10. 集成测试（8小时）
11. 性能测试（6小时）
12. 跨平台测试（8小时）
13. 用户验收测试（10小时）
14. 构建配置（4小时）
15. 打包和分发（8小时）

## 风险评估

- **高风险**：配置持久化（set_config 当前仅部分实现）
- **中风险**：前端组件完成（UI 需要完全实现）
- **低风险**：后端功能（实现和测试良好）
